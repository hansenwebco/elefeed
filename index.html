<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, interactive-widget=resizes-visual" />
  <title>Elefeed</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@400;500&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;1,9..40,300&display=swap" rel="stylesheet" />
  <link rel="manifest" href="manifest.json">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/base.css" />
  <link rel="stylesheet" href="css/layout.css" />
  <link rel="stylesheet" href="css/login.css" />
  <link rel="stylesheet" href="css/posts.css" />
  <link rel="stylesheet" href="css/compose.css" />
  <link rel="stylesheet" href="css/drawers.css" />
  <link rel="stylesheet" href="css/trending.css" />
  <link rel="stylesheet" href="css/components.css" />
</head>

<body>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LOGIN SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="login-screen" class="screen active">
    <div class="login-card">
      <div class="login-logo">
        <div class="wordmark"><span>e</span>lefeed</div>
        <div class="tagline">// // a tidy mastodon client</div>
      </div>

      <div class="login-form-box">
        <label class="form-label" for="server-input">mastodon server</label>
        <div class="server-input-wrap">
          <span class="server-prefix">https://</span>
          <input type="text" id="server-input" class="server-input" placeholder="mastodon.social" autocomplete="off" autocapitalize="off" spellcheck="false" />
        </div>
        <div class="quick-servers">
          <button class="quick-server-btn" data-server="mastodon.social">mastodon.social</button>
          <button class="quick-server-btn" data-server="mastodon.online">mastodon.online</button>
          <button class="quick-server-btn" data-server="fosstodon.org">fosstodon.org</button>
          <button class="quick-server-btn" data-server="hachyderm.io">hachyderm.io</button>
          <button class="quick-server-btn" data-server="infosec.exchange">infosec.exchange</button>
          <button class="quick-server-btn" data-server="chaos.social">chaos.social</button>
        </div>

        <button class="login-btn" id="login-btn">Log in with Mastodon ‚Üí</button>
        <div id="login-error" style="display:none;margin-top:14px;background:rgba(255,107,107,0.10);border:1px solid rgba(255,107,107,0.25);border-radius:6px;color:#ff8080;font-family:var(--font-mono);font-size:11.5px;padding:10px 12px;line-height:1.6;white-space:pre-wrap;word-break:break-word;"></div>
      </div>

      <p class="login-footer">
        No account data is stored on any server.<br />
        Your access token lives in your browser only.<br />
        <a href="https://joinmastodon.org" target="_blank">New to Mastodon?</a>
      </p>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CALLBACK SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="callback-screen" class="screen">
    <div class="callback-message">
      <div class="spinner"></div>
      <p>Completing sign-in‚Ä¶</p>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê APP SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="app-screen" class="screen">
    <!-- Compose Sidebar -->
    <aside class="compose-sidebar">
      <div class="compose-sidebar-body">
        <div style="display:flex; gap:8px; margin-bottom:4px;">
          <select class="hashtag-filter-select compose-visibility" id="compose-visibility-sidebar" style="padding:6px 28px 6px 10px;font-size:12px;">
            <option value="public">üåê Public</option>
            <option value="unlisted">üîì Unlisted</option>
            <option value="private">üîí Followers</option>
            <option value="direct">‚úâÔ∏è Direct</option>
          </select>
          <button style="border:1px solid var(--border); border-radius:4px; padding:4px 8px; font-size:12px; color:var(--text-muted); background:transparent; font-family:var(--font-body); cursor:pointer; display:flex; gap:4px; align-items:center;">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2A10 10 0 1 0 22 12 10 10 0 0 0 12 2z" />
              <line x1="2" y1="12" x2="22" y2="12" />
              <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
            </svg>
            English
          </button>
        </div>

        <div class="compose-cw-section" id="compose-cw-section-sidebar" style="display:none;">
          <input type="text" class="compose-cw-input" id="compose-cw-input-sidebar" placeholder="Content warning" maxlength="500" />
        </div>

        <div id="compose-reply-bar-sidebar" style="display:none;font-size:12px;color:var(--text-muted);margin-bottom:8px;">
          <span id="compose-context-type-sidebar">Replying to</span> <span id="compose-reply-to-sidebar" style="color:var(--accent2);font-weight:500;"></span>
          <button id="compose-reply-cancel-sidebar" onclick="resetReplyState()" style="margin-left:8px;background:none;border:none;color:var(--danger);cursor:pointer;font-size:11px;">Cancel</button>
        </div>

        <div class="compose-textarea" id="compose-textarea-sidebar" contenteditable="true" placeholder="What's on your mind?" style="min-height:90px;"></div>

        <div class="compose-media-preview" id="compose-media-preview-sidebar"></div>

        <div class="compose-toolbar" style="border-top:none; padding-top:4px;">
          <div class="compose-toolbar-left">
            <button class="compose-tool-btn" id="compose-media-btn-sidebar" title="Add media">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                <circle cx="8.5" cy="8.5" r="1.5" />
                <polyline points="21 15 16 10 5 21" />
              </svg>
            </button>
            <button class="compose-tool-btn" id="compose-emoji-btn-sidebar" title="Emoji">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10" />
                <path d="M8 14s1.5 2 4 2 4-2 4-2" />
                <line x1="9" y1="9" x2="9.01" y2="9" />
                <line x1="15" y1="9" x2="15.01" y2="9" />
              </svg>
            </button>
            <button class="compose-tool-btn" id="compose-cw-btn-sidebar" title="Content warning">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" />
                <line x1="12" y1="9" x2="12" y2="13" />
                <line x1="12" y1="17" x2="12.01" y2="17" />
              </svg>
            </button>
            <input type="file" id="compose-media-input-sidebar" accept="image/*,video/*" multiple style="display:none;" />
          </div>
          <div style="display:flex; align-items:center; justify-content:flex-end; gap:12px; margin-left:auto;">
            <span class="compose-char-count" id="compose-char-count-sidebar" style="font-size:14px; color:var(--text-dim);">500</span>
            <button class="compose-post-btn" id="compose-post-btn-sidebar">Post</button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Feed Area -->
    <div class="main-wrapper">
      <header class="app-header">
        <div class="header-top">
          <div class="header-wordmark" id="header-wordmark-btn" style="cursor:pointer;" title="Refresh feed"><span>e</span>lefeed</div>
          <div class="header-actions">
            <button class="icon-btn" id="compose-btn" title="New post">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 20h9"></path>
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
              </svg>
            </button>
            <button class="icon-btn" id="refresh-btn" title="Refresh feed">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <div class="notif-bell-wrap">
              <button class="icon-btn" id="notif-btn" title="Notifications">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                  <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
              </button>
              <span class="notif-badge" id="notif-badge"></span>
            </div>
            <div style="position:relative; display:inline-flex;">
              <div class="avatar-btn" id="avatar-btn" title="Profile options">
                <img id="user-avatar" src="" alt="" />
              </div>
              <div class="boost-dropdown" id="profile-dropdown" style="right:0; left:auto; top:100%; bottom:auto; margin-top:8px; min-width:150px; transform-origin: top right;">
                <button class="boost-dropdown-item" id="profile-view-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                  </svg>
                  <span>View Profile</span>
                </button>
                <button class="boost-dropdown-item" id="bookmarks-view-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" />
                  </svg>
                  <span>Bookmarks</span>
                </button>
                <button class="boost-dropdown-item" id="logout-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                    <polyline points="16 17 21 12 16 7" />
                    <line x1="21" y1="12" x2="9" y2="12" />
                  </svg>
                  <span style="color:var(--danger)">Sign Out</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="tab-bar" role="tablist">
          <div class="tab-btn-wrap">
            <button class="tab-btn active" role="tab" data-tab="feed" aria-selected="true" id="tab-btn-feed">
              <span class="tab-btn-label">Home ¬∑ All</span><span class="tab-chevron">‚ñæ</span>
            </button>
            <div class="tab-dropdown" id="tab-dropdown-feed">
              <button class="tab-dropdown-item active" data-filter="all">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="3" y="3" width="7" height="7" />
                  <rect x="14" y="3" width="7" height="7" />
                  <rect x="3" y="14" width="7" height="7" />
                  <rect x="14" y="14" width="7" height="7" />
                </svg>
                All
              </button>
              <button class="tab-dropdown-item" data-filter="following">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
                Followed Profiles
              </button>
              <button class="tab-dropdown-item" data-filter="hashtags">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="4" y1="9" x2="20" y2="9" />
                  <line x1="4" y1="15" x2="20" y2="15" />
                  <line x1="10" y1="3" x2="8" y2="21" />
                  <line x1="16" y1="3" x2="14" y2="21" />
                </svg>
                Followed Hashtags
              </button>
            </div>
          </div>
          <div class="tab-btn-wrap">
            <button class="tab-btn" role="tab" data-tab="explore" aria-selected="false" id="tab-btn-explore">
              <span class="tab-btn-label">Explore</span><span class="tab-chevron" style="display:none">‚ñæ</span>
            </button>
            <div class="tab-dropdown" id="tab-dropdown-explore">
              <button class="tab-dropdown-item active" data-subtab="posts">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                Trending Posts
              </button>
              <button class="tab-dropdown-item" data-subtab="hashtags">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="4" y1="9" x2="20" y2="9" />
                  <line x1="4" y1="15" x2="20" y2="15" />
                  <line x1="10" y1="3" x2="8" y2="21" />
                  <line x1="16" y1="3" x2="14" y2="21" />
                </svg>
                Trending Hashtags
              </button>
              <button class="tab-dropdown-item" data-subtab="people">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                  <circle cx="9" cy="7" r="4" />
                  <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                  <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                </svg>
                Trending People
              </button>
              <button class="tab-dropdown-item" data-subtab="news">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2" />
                  <path d="M18 14h-8" />
                  <path d="M15 18h-5" />
                  <path d="M10 6h8v4h-8V6Z" />
                </svg>
                Trending News
              </button>
            </div>
          </div>
        </div>
      </header>

      <div class="demo-notice" id="demo-notice" style="display:none;">
        ‚ö° Demo mode ‚Äî showing sample data. Connect to a real Mastodon server to see your actual feed.
      </div>

      <div class="offline-bar" id="offline-bar">
        ‚ö† Network unavailable ‚Äî showing cached data
      </div>

      <main class="feed-container">
        <!-- Inline thread panel (desktop: replaces the feed with back button) -->
        <div class="thread-inline-panel" id="thread-inline-panel">
          <div class="thread-back-bar">
            <button class="thread-back-btn" id="thread-back-btn" aria-label="Back to feed">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="19" y1="12" x2="5" y2="12" />
                <polyline points="12 19 5 12 12 5" />
              </svg>
              Back
            </button>

          </div>
          <div class="thread-inline-inner" id="thread-inline-content">
            <div class="thread-status">
              <div class="spinner"></div>
            </div>
          </div>
        </div>

        <!-- Feed Tab (unified: All / Following / #Hashtags) -->
        <div class="tab-panel active" id="panel-feed" role="tabpanel">
          <div class="hashtag-filter-bar" id="hashtag-filter-bar" style="display:none;">
            <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap; width: 100%;">
              <select class="hashtag-filter-select" id="hashtag-filter-select">
                <option value="all">All Followed Hashtags</option>
              </select>
              <div class="hashtag-search-wrap">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="position:absolute; left:10px; top:50%; transform:translateY(-50%); color:var(--text-dim); pointer-events:none;">
                  <circle cx="11" cy="11" r="8" />
                  <line x1="21" y1="21" x2="16.65" y2="16.65" />
                </svg>
                <input type="text" id="hashtag-search-input" class="hashtag-search-input" placeholder="Search hashtag..." autocomplete="off" />
              </div>
              <button id="hashtag-follow-btn" class="profile-follow-btn" style="display:none; margin-top:0; height:36px;"></button>
            </div>
          </div>
          <div class="feed-loading" id="feed-loading">
            <div class="skeleton-posts" id="feed-skeleton"></div>
          </div>
          <div class="error-banner" id="feed-error"></div>
          <div style="position:relative;">
            <div id="feed-posts" style="position:relative;"></div>
            <!-- Move overlay pill to end of body to avoid stacking context issues -->
            <button id="new-posts-pill" class="overlay-pill" style="display:none;">New posts</button>
          </div>
        </div>

        <!-- Explore Tab -->
        <div class="tab-panel" id="panel-explore" role="tabpanel">
          <div class="trending-subpanel active" id="trending-subpanel-posts">
            <div class="feed-loading" id="trending-posts-loading" style="display:none;">
              <div class="skeleton-posts" id="trending-posts-skeleton"></div>
            </div>
            <div class="error-banner" id="trending-posts-error"></div>
            <div id="trending-posts-list"></div>
          </div>
          <div class="trending-subpanel" id="trending-subpanel-hashtags">
            <div class="feed-loading" id="trending-hashtags-loading" style="display:none;">
              <div class="skeleton-posts" id="trending-hashtags-skeleton"></div>
            </div>
            <div class="error-banner" id="trending-hashtags-error"></div>
            <div class="trending-section">
              <div id="trending-hashtags-list" class="trending-tags-grid"></div>
            </div>
          </div>
          <div class="trending-subpanel" id="trending-subpanel-people">
            <div class="feed-loading" id="trending-people-loading" style="display:none;">
              <div class="skeleton-posts" id="trending-people-skeleton"></div>
            </div>
            <div class="error-banner" id="trending-people-error"></div>
            <div class="trending-section">
              <div id="trending-people-list" class="trending-people-grid"></div>
            </div>
          </div>
          <div class="trending-subpanel" id="trending-subpanel-news">
            <div class="feed-loading" id="trending-news-loading" style="display:none;">
              <div class="skeleton-posts" id="trending-news-skeleton"></div>
            </div>
            <div class="error-banner" id="trending-news-error"></div>
            <div class="trending-section">
              <div id="trending-news-list" class="trending-links-list"></div>
            </div>
          </div>
        </div>
      </main>
    </div>
    <!-- end main-wrapper -->

    <!-- Profile Drawer -->
    <div class="profile-backdrop" id="profile-backdrop"></div>
    <aside class="profile-drawer" id="profile-drawer" aria-hidden="true">
      <button class="profile-close" id="profile-close" aria-label="Close profile">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </button>
      <div class="profile-drawer-inner">
        <div id="profile-content">
          <div class="profile-loading">
            <div class="spinner"></div>
          </div>
        </div>
      </div>
    </aside>

    <!-- Notification Drawer -->
    <div class="notif-backdrop" id="notif-backdrop"></div>
    <aside class="notif-drawer" id="notif-drawer" aria-hidden="true">
      <div class="notif-drawer-header">
        <span class="notif-drawer-title">Notifications</span>
        <button class="notif-close-btn" id="notif-close" aria-label="Close notifications">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
        </button>
      </div>
      <div class="notif-filters">
        <button class="notif-filter-btn active" data-notif-filter="all">All</button>
        <button class="notif-filter-btn" data-notif-filter="mention">Mentions</button>
        <button class="notif-filter-btn" data-notif-filter="reblog">Boosts</button>
        <button class="notif-filter-btn" data-notif-filter="favourite">Favorites</button>
        <button class="notif-filter-btn" data-notif-filter="follow">Follows</button>
      </div>
      <div class="notif-drawer-inner" id="notif-content">
        <div class="notif-empty">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
          <p style="font-size:13px;">No notifications yet</p>
        </div>
      </div>
    </aside>

    <!-- Thread Drawer -->
    <div class="thread-backdrop" id="thread-backdrop"></div>
    <aside class="thread-drawer" id="thread-drawer" aria-hidden="true" aria-label="Thread view">
      <div class="thread-drawer-header">
        <button class="thread-close-btn" id="thread-close-btn" aria-label="Close thread">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
        </button>
        <span class="thread-drawer-title">Thread</span>
      </div>
      <div class="thread-drawer-inner" id="thread-content">
        <div class="thread-status">
          <div class="spinner"></div>
        </div>
      </div>
    </aside>

    <!-- Compose Drawer -->
    <div class="compose-backdrop" id="compose-backdrop"></div>
    <aside class="compose-drawer layout-float" id="compose-drawer" aria-hidden="true">
      <div class="compose-drawer-inner">
        <div class="compose-header">
          <span class="compose-title">New post</span>
          <button class="compose-close" id="compose-close" aria-label="Close">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18" />
              <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
          </button>
        </div>

        <div class="compose-body">
          <div class="compose-cw-section" id="compose-cw-section" style="display:none;">
            <input type="text" class="compose-cw-input" id="compose-cw-input" placeholder="Content warning" maxlength="500" />
          </div>

          <div id="compose-reply-bar" style="display:none;font-size:12px;color:var(--text-muted);margin-bottom:8px;">
            <span id="compose-context-type">Replying to</span> <span id="compose-reply-to" style="color:var(--accent2);font-weight:500;"></span>
            <button id="compose-reply-cancel" onclick="resetReplyState()" style="margin-left:8px;background:none;border:none;color:var(--danger);cursor:pointer;font-size:11px;">Cancel</button>
          </div>
          <div class="compose-textarea" id="compose-textarea" contenteditable="true" placeholder="What's on your mind?"></div>

          <div class="compose-media-preview" id="compose-media-preview"></div>

          <div class="compose-toolbar">
            <div class="compose-toolbar-left">
              <button class="compose-tool-btn" id="compose-media-btn" title="Add media">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                  <circle cx="8.5" cy="8.5" r="1.5" />
                  <polyline points="21 15 16 10 5 21" />
                </svg>
              </button>
              <button class="compose-tool-btn" id="compose-emoji-btn" title="Emoji">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10" />
                  <path d="M8 14s1.5 2 4 2 4-2 4-2" />
                  <line x1="9" y1="9" x2="9.01" y2="9" />
                  <line x1="15" y1="9" x2="15.01" y2="9" />
                </svg>
              </button>
              <button class="compose-tool-btn" id="compose-cw-btn" title="Content warning">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" />
                  <line x1="12" y1="9" x2="12" y2="13" />
                  <line x1="12" y1="17" x2="12.01" y2="17" />
                </svg>
              </button>
              <input type="file" id="compose-media-input" accept="image/*,video/*" multiple style="display:none;" />
            </div>
            <div class="compose-toolbar-right">
              <select class="hashtag-filter-select compose-visibility" id="compose-visibility" style="padding:6px 28px 6px 10px;font-size:12px;">
                <option value="public">üåê Public</option>
                <option value="unlisted">üîì Unlisted</option>
                <option value="private">üîí Followers</option>
                <option value="direct">‚úâÔ∏è Direct</option>
              </select>
            </div>
          </div>

          <div class="compose-footer">
            <span class="compose-char-count" id="compose-char-count">500</span>
            <button class="compose-post-btn" id="compose-post-btn">Post</button>
          </div>
        </div>
      </div>
    </aside>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <!-- Emoji Picker -->
  <div class="emoji-picker" id="emoji-picker">
    <div class="emoji-picker-header">
      <input type="text" id="emoji-search" class="emoji-picker-search" placeholder="Search emojis..." autocomplete="off">
    </div>
    <div class="emoji-picker-body" id="emoji-picker-body"></div>
  </div>

  <div class="mention-suggestions" id="mention-suggestions"></div>
  <div class="hashtag-suggestions" id="hashtag-suggestions"></div>

  <!-- Alt Text Modal -->
  <div id="alt-text-modal" class="compose-alt-modal" style="display:none; position:fixed; inset:0; z-index:9999; background:rgba(13,13,15,0.85); align-items:center; justify-content:center; backdrop-filter:blur(4px); -webkit-backdrop-filter:blur(4px);">
    <div style="background:var(--surface); width:min(500px, 100%); margin: 0 16px; border:1px solid var(--border); border-radius:12px; display:flex; flex-direction:column; overflow:hidden; box-shadow:0 12px 32px rgba(0,0,0,0.5);">
      <div style="padding:16px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center;">
        <h3 style="font-size:16px; font-weight:500;">Image Description</h3>
        <button id="alt-modal-close" style="background:none; border:none; color:var(--text-muted); cursor:pointer;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
        </button>
      </div>
      <div style="padding:16px; flex:1; overflow-y:auto;">
        <img id="alt-modal-img" src="" style="width:100%; max-height:200px; object-fit:contain; border-radius:8px; margin-bottom:16px; background:var(--bg);" />
        <textarea id="alt-modal-input" placeholder="Describe this image for users with visual impairments..." style="width:100%; min-height:120px; background:var(--bg); border:1px solid var(--border); border-radius:8px; padding:12px; color:var(--text); font-family:var(--font-body); font-size:14px; resize:vertical; outline:none; transition:border-color 0.2s;"></textarea>
      </div>
      <div style="padding:16px; border-top:1px solid var(--border); display:flex; justify-content:flex-end; gap:12px;">
        <span id="alt-modal-count" style="margin-right:auto; color:var(--text-muted); font-size:13px; align-self:center;">1500</span>
        <button id="alt-modal-cancel" style="padding:8px 16px; background:none; border:1px solid var(--border); border-radius:6px; color:var(--text); cursor:pointer;">Cancel</button>
        <button id="alt-modal-save" style="padding:8px 16px; background:var(--accent); border:none; border-radius:6px; color:#fff; font-weight:500; cursor:pointer;">Done</button>
      </div>
    </div>
  </div>

  <!-- Application entry point -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('js/sw.js');
    }
  </script>
  <script type="module" src="js/app.js"></script>
</body>

</html>